---
title: "Medical Cost Analysis Project"
author: "Orator Murambiwa"
date: "2025-11-16"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown


This project analyzes the Medical Cost Personal Dataset from Kaggle, which contains 
1,338 patient records with variables such as age, sex, BMI, smoking status, number of 
children, region, and individual medical charges. 

The goal of this project is to explore how demographic and lifestyle factors influence 
medical costs. The response variable for the regression model is charges, representing 
the total medical cost billed to an individual. Predictor variables include age, BMI, 
number of children, and smoking status



```{r}
install.packages("ggplot2")
install.packages("dplyr")

```


```{r}
library(ggplot2)
library(dplyr)
```
Loading the Dataset

```{r}
insurance <- read.csv("insurance.csv")
head(insurance)

```
Data Exploration

```{r}
summary(insurance)
sd(insurance$age)
sd(insurance$bmi)
sd(insurance$charges)

```
Creating Data Visualisations

Histograms

```{r}
hist(insurance$age, main="Age Distribution", col="lightblue")
hist(insurance$bmi, main="BMI Distribution", col="lightgreen")
hist(insurance$charges, main="Medical Charges Distribution", col="lightpink")

```
Scatterplots
```{r}
plot(insurance$bmi, insurance$charges,
     main="BMI vs Charges", xlab="BMI", ylab="Charges")

plot(insurance$age, insurance$charges,
     main="Age vs Charges", xlab="Age", ylab="Charges")

```

Boxplot(smoker status)

```{r}
boxplot(charges ~ smoker, data=insurance,
        main="Charges by Smoking Status",
        xlab="Smoker (0 = No, 1 = Yes)")

```

Data Preprocessing

```{r}
insurance$smoker <- ifelse(insurance$smoker == "yes", 1, 0)
insurance$sex <- ifelse(insurance$sex == "male", 1, 0)

```

Linear Regression Model

```{r}
model <- lm(charges ~ age + bmi + children + smoker, data=insurance)
summary(model)

```
Residual Plot 
```{r}
plot(model$residuals,
     main="Residual Plot",
     xlab="Index",
     ylab="Residuals")
abline(h=0, col="red")

```






























